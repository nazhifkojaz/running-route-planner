:root{
  --bg:#0b1020; --panel:#0b1222; --line:#1f2640; --fg:#e2e8f0; --muted:#9fb0d3;
  --accent:#38bdf8; --danger:#ef4444;
}
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Arial;background:var(--bg);color:var(--fg)}
#map{position:fixed;inset:0;width:100vw;height:100svh}

/* Generic panel */
.panel{
  position:fixed; z-index:10; background:rgba(11,18,34,.75); backdrop-filter:blur(6px);
  border:1px var(--line); border-radius:14px; box-shadow:0 8px 30px rgba(0,0,0,.35);
}
.panel .small{font-size:12px} .panel .muted{color:var(--muted)}

/* Stats (top-left) */
.panel.stats{
  top:env(safe-area-inset-top,10px); left:env(safe-area-inset-left,10px);
  padding:10px 12px; min-width:100px; font-size:14px;
}
.panel.stats strong{font-weight:600}

/* Distance (top-right) — match stats "size" */
.panel.distance{
  top:env(safe-area-inset-top,10px); right:env(safe-area-inset-right,10px);
  padding:10px 12px; min-width:50px; font-size:42px; font-weight:600;
  font-variant-numeric:tabular-nums;
}


/* Undo button matches the same footprint and aligns under the bracket */
.btn-square.undo{
  width: 44px;
  height: 44px;
  border-radius: 10px;
  border: 1px solid var(--line);
  background: #0e1530;
  color: var(--fg);
  font-size: 18px;
  font-weight: 700;
  line-height: 44px;
  text-align: center;
  box-shadow: 0 8px 24px rgba(0,0,0,.4);
}

.btn-square:active{transform:translateY(1px)}

/* Settings toggle button (bottom-right) — aligned to bottom baseline */
.fab.settings{
  position:fixed; right:env(safe-area-inset-right,14px); bottom:env(safe-area-inset-bottom,14px);
  z-index:11; border-radius:12px; border:1px var(--line); background:#0e1530; color:var(--fg);
  padding:12px 16px; font-size:20px; line-height:1; cursor:pointer; box-shadow:0 8px 24px rgba(0,0,0,.4);
}
.fab.settings:active{transform:translateY(1px)}

/* Settings sheet */
.panel.settings{
  right:env(safe-area-inset-right,14px);
  bottom:calc(env(safe-area-inset-bottom,14px) + 60px);
  width:min(460px, 92vw); padding:12px;
}
.panel.settings.hidden{display:none}
.sheet-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
.icon-btn{border:1px solid var(--line);background:#0e1530;color:var(--fg);border-radius:10px;padding:6px 10px;cursor:pointer}

section{border-top:1px solid var(--line);padding-top:10px;margin-top:10px}
section:first-of-type{border-top:0;padding-top:0;margin-top:0}
h3,h4{margin:6px 2px}
.row{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:8px}
.field{display:flex;flex-direction:column;gap:6px}
.field input{background:#0e1530;border:1px solid #23305e;color:var(--fg);padding:10px;border-radius:10px;outline:none}
.field input:focus{border-color:var(--accent);box-shadow:0 0 0 3px rgba(56,189,248,.2)}
.check{display:inline-flex;gap:8px;align-items:center}
button.danger{border-color:#6b1f2d;background:#2b0e16;color:#ffd7dc}
button[disabled], .chip.disabled{opacity:.6;cursor:not-allowed}

/* Icon chips */
.chip{display:inline-flex;align-items:center;gap:6px;border:1px solid var(--line);padding:6px 10px;border-radius:999px;background:#0e1530}
.chip .ico{font-size:18px;line-height:1}
.chip.active{border-color:var(--accent)}
.row.profiles{grid-template-columns:repeat(3,auto)}

/* Optional: keep engine radios tidy inside the sheet */
#panel .row .check {
  display: flex;
  align-items: center;
  gap: 8px;
}


/* Horizontal tools bracket (same visual system as left tools) */
.panel.tools.horizontal{
  display: flex;
  flex-direction: row;
  gap: 0;
  padding: 0;
  border-radius: 12px;
  overflow: hidden;
}

/* Each profile button: 44x44, with divider between */
.panel.tools.horizontal .btn-square{
  width: 44px;
  height: 44px;
  border: 0;
  border-right: 1px solid var(--line);
  background: #0e1530;
  color: var(--fg);
  font-size: 18px;
  line-height: 44px;
  text-align: center;
  cursor: pointer;
  box-shadow: 0 8px 24px rgba(0,0,0,.4);
}
.panel.tools.horizontal .btn-square:last-child{ border-right: 0; }

/* Optional active outline for the current profile (Car) */
.panel.tools.horizontal .btn-square[aria-pressed="true"],
.panel.tools.horizontal .btn-square.active{
  outline: 0.5px solid var(--accent);
  outline-offset: -0.5px;
  border-right-color: var(--line); /* keep divider consistent */
}

/* Utility */
.hidden{display:none}

/* Kilometer labels placed along the route */
.leaflet-tooltip.km-tip{
  background: rgba(255,255,255,.96);
  color: #111;
  border: 1px solid rgba(0,0,0,.4);
  border-radius: 999px;
  padding: 3px 8px;
  font-size: 13px;
  font-weight: 800;
  line-height: 1;
  box-shadow: 0 4px 12px rgba(0,0,0,.35);
  text-shadow:
    0 0 2px rgba(0,0,0,.25),
    0 0 6px rgba(0,0,0,.25);
  pointer-events: none; 
}
/* 1) Lift BOTH bottom corners (left & right) by a common offset */
.leaflet-control-container .leaflet-bottom {
  bottom: calc(env(safe-area-inset-bottom, 0px) + 20px);
}

/* 2) Pin the attribution to the very bottom so it no longer shifts other controls */
.leaflet-control-attribution {
  position: fixed !important;
  right: max(0px, env(safe-area-inset-right));
  bottom: max(0px, env(safe-area-inset-bottom));
  margin: 0 !important;
  background: rgba(255,255,255,.9);
  color: #000;
  border-radius: 4px;
  padding: 2px 6px;
  line-height: 1.2;
  box-shadow: 0 2px 6px rgba(0,0,0,.2);
  z-index: 1000;                        /* above map, below your panels */
  pointer-events: auto;                 /* links still clickable */
}

/* (nice-to-have) tidy the prefix text */
.leaflet-control-attribution .leaflet-control-attribution-link { display: none; }

.leaflet-bar a.leaflet-control-undo,
.leaflet-bar a.leaflet-control-gps{
  display:block;
  text-align:center;
  text-decoration:none;
  background:#fff;
  color:#000;
  font-size:18px;
}
.leaflet-bar a.leaflet-control-undo:hover,
.leaflet-bar a.leaflet-control-gps:hover{ background:#f4f4f4; }


/* Use Leaflet's "bar" look */
.leaflet-control.settings-toggle.leaflet-bar,
.leaflet-control.settings-toggle .leaflet-bar{
  background:#fff;
  border-radius:4px;
  box-shadow: 0 2px 6px rgba(0,0,0,.25);
  overflow:hidden;
}

/* The actual button */
.leaflet-control.settings-toggle a{
  display:block;
  text-align:center;
  text-decoration:none;
  color:#000;
  font-size:18px;
}
.leaflet-control.settings-toggle a:hover{ background:#f4f4f4; }
.leaflet-control.settings-toggle a:active{ transform: translateY(1px); }

/* Bottom-center horizontal pill that matches Leaflet style */
.leaflet-control.profile-center{
  display:flex;
  gap:0;              /* seamless bar */
  border-radius:4px;
  box-shadow: 0 2px 6px rgba(0,0,0,.25);
  overflow:hidden;
  background:#fff;
  margin-bottom: calc(env(safe-area-inset-bottom, 0px) + 20px)
}

/* Buttons inside the bar */
.leaflet-control.profile-center a{
  display:inline-block;
  text-align:center;
  text-decoration:none;
  color:#000;
  font-size:18px;
  border-right:1px solid rgba(0,0,0,.12);
}
.leaflet-control.profile-center a:last-child{ border-right:none; }
.leaflet-control.profile-center a:hover{ background:#f4f4f4; }
.leaflet-control.profile-center a[aria-pressed="true"]{
  background:#f0f0f0;
  font-weight:600;
}
.leaflet-control.profile-center a[aria-disabled="true"]{
  opacity:.45;
  pointer-events:none;
}


@media (max-width:640px){
  .row{grid-template-columns:1fr}
}
